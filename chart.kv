#:kivy 1.11.1
#:import datetime datetime

<BalanceChart>:
    display:display
    dashboard:dashboard

    BoxLayout:
        pos:self.parent.pos
        size:self.parent.size
        orientation:'vertical'
        padding:50
        spacing:10

        Display:
            id:display
            size_hint:1, 0.8

        Dashboard:
            id:dashboard
            size_hint:1, 0.2


<Dashboard@FloatLayout>:
    date_range:date_range
    category_selector:category_selector
    period_selector:period_selector

    DateRange:
        id:date_range
        pos_hint:{'x':0.05, 'y':0.5}
        size_hint:0.4, 0.5

    PeriodSelector:
        id:period_selector
        pos_hint:{'x':0.5, 'y':0.5}
        size_hint:0.5, 0.5

    CategorySelector:
        id:category_selector
        pos_hint:{'x':0, 'y':0}
        size_hint:1, 0.5


<DateRange>:
    begin:begin
    end:end
    orientation:'horizontal'

    DateSelector:
        id:begin

    Label:
        size_hint:0.1, 1
        text:'-'

    DateSelector:
        id:end


<DateSelector>:
    id:date_selector
    year_spinner:year_spinner
    month_spinner:month_spinner
    day_spinner:day_spinner

    BoxLayout:
        pos:self.parent.pos
        size:self.parent.size
        orientation:'horizontal'

        Spinner:
            id:year_spinner
            text:str(datetime.date.today().year)
            values:tuple(str(i) for i in range(min(entry.date.year for entry in app.book), max(entry.date.year for entry in app.book) + 1))
            on_text:date_selector.update_year()

        Spinner:
            id:month_spinner
            text:str(datetime.date.today().month)
            values:tuple(str(i) for i in range(1, 13))
            on_text:date_selector.update_month()

        Spinner:
            id:day_spinner
            text:str(datetime.date.today().day)
            values:tuple(str(i) for i in range(1, 32))
            on_text:date_selector.update_day()


<CategorySelector>:
    income:income
    outgo:outgo
    balance:balance
    orientation:'horizontal'
    padding:20
    spacing:20

    CategoryToggle:
        id:income
        text:'income'

    CategoryToggle:
        id:outgo
        text:'outgo'

    CategoryToggle:
        id:balance
        text:'balance'


<PeriodSelector>:
    day:day
    week:week
    month:month
    year:year
    orientation:'horizontal'
    padding:20
    spacing:20

    PeriodToggle:
        id:day
        text:'day'

    PeriodToggle:
        id:week
        text:'week'

    PeriodToggle:
        id:month
        text:'month'

    PeriodToggle:
        id:year
        text:'year'


<Bar>:
    canvas:
        Color:
            rgba:(1, 0, 0, 0.75)
        Rectangle:
            pos:[self.x + self.width * 0.4, self.y + self.height * self.origin]
            size:(self.width * 0.2, self.height * self.value)


<Display>:
    x_axis:x_axis
    y_axis:y_axis
    plot_area:plot_area

    XAxis:
        id:x_axis
        pos_hint:{'x':0.1, 'y':0}
        size_hint:0.9, 0.1

    YAxis:
        id:y_axis
        pos_hint:{'x':0, 'y':0.1}
        size_hint:0.1, 0.9

    PlotArea:
        id:plot_area
        pos_hint:{'x':0.1, 'y':0.1}
        size_hint:0.9, 0.9
